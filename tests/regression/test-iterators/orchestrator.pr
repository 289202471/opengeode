SYSTEM orchestrator;
    /* CIF TEXT (880, 108), (315, 128) */
    use datatypes comment  'dataview-uniq.asn';

signal pulse (t_int);

signal arr (t_seqof);

signal paramless;
    /* CIF ENDTEXT */
    CHANNEL c
        FROM ENV TO orchestrator WITH pulse,
arr,
paramless;
    ENDCHANNEL;
    BLOCK orchestrator;
        SIGNALROUTE r
            FROM ENV TO orchestrator WITH pulse,
arr,
paramless;
        CONNECT c AND r;
        /* CIF PROCESS (465, 158), (265, 176) */
        PROCESS orchestrator;
            /* CIF TEXT (920, 71), (268, 140) */
            -- Text area for declarations and comments

dcl t t_int := 0;

dcl counter t_int := 0;

dcl seqof t_seqof;
            /* CIF ENDTEXT */
            /* CIF START (444, 48), (70, 34) */
            START;
                /* CIF PROCEDURECALL (373, 102), (211, 35) */
                CALL writeln( 'Orchestrator startup');
                /* CIF NEXTSTATE (445, 152), (67, 35) */
                NEXTSTATE wait;
            /* CIF STATE (693, 94), (70, 35) */
            STATE running;
                /* CIF INPUT (693, 149), (70, 35) */
                INPUT *;
                    /* CIF NEXTSTATE (693, 204), (70, 35) */
                    NEXTSTATE wait;
            ENDSTATE;
            /* CIF STATE (445, 152), (67, 35) */
            STATE wait;
                /* CIF INPUT (190, 207), (70, 35) */
                INPUT pulse(t);
                    /* CIF DECISION (190, 262), (70, 50) */
                    DECISION t;
                        /* CIF ANSWER (145, 332), (70, 23) */
                        (0):
                            /* CIF NEXTSTATE (145, 375), (70, 35) */
                            NEXTSTATE wait;
                        /* CIF ANSWER (235, 332), (70, 23) */
                        else:
                            /* CIF NEXTSTATE (235, 375), (70, 35) */
                            NEXTSTATE running;
                    ENDDECISION;
                /* CIF INPUT (373, 207), (83, 35) */
                INPUT arr(seqof);
                    /* CIF TASK (314, 262), (202, 35) */
                    TASK counter := (counter + 1) mod 4;
                    /* CIF DECISION (355, 317), (121, 50) */
                    DECISION seqof = {4,4,4,4}
and counter = 0;
                        /* CIF ANSWER (336, 387), (70, 23) */
                        (true):
                        /* CIF ANSWER (426, 387), (70, 23) */
                        (false):
                            /* CIF TASK (409, 430), (103, 35) */
                            TASK seqof(1) := 1;
                    ENDDECISION;
                    /* CIF NEXTSTATE (380, 480), (70, 35) */
                    NEXTSTATE -;
                /* CIF INPUT (532, 207), (83, 35) */
                INPUT paramless;
                    /* CIF TASK (525, 262), (97, 38) */
                    TASK counter := 0,
t := 1;
                    /* CIF NEXTSTATE (539, 320), (70, 35) */
                    NEXTSTATE running;
            ENDSTATE;
        ENDPROCESS orchestrator;
    ENDBLOCK;
ENDSYSTEM;